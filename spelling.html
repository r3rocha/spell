<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Spell, the dog | Kids spelling game</title>
        
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no shrink-to-fit=no">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        
        <link rel="shortcut icon" type="image/x-icon" href="images/favicon.png" />
        
        <link rel="stylesheet" type="text/css" href="slick/slick.css"/>
        <link rel="stylesheet" type="text/css" href="css/normalize.css">
        <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="slick/slick-theme.css"/>
        <link rel="stylesheet" type="text/css" href="css/style.css">

		<script src="http://cdnjs.cloudflare.com/ajax/libs/svg.js/2.3.6/svg.min.js"></script>
		<script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/snap.svg/0.4.1/snap.svg-min.js"></script>
        <script src="js/bootstrap.min.js"></script>
	</head>
    
	<body id="game" class="grad">

	<header id="header" class="col-xs-12">

		<div id="user" class="col-xs-3 col-xs-offset-9">
			<button id="useravatar" type="button" data-toggle="modal" data-target="#userModal"><img /></button>
			<div id="usercoins"><span class="coins"></span></div>
		</div>
		<div id="stars" class="col-xs-3 col-xs-offset-9">
			<div class="star on"></div>
			<div class="star on"></div>
			<div class="star on"></div>
			<div class="star on"></div>
			<div class="star on"></div>
		</div>

	</header>
	
	<content id="content" class="row">

		<div id="figure">
			<svg id="svg-dog-seated" class="dog-seated col-xs-2"></svg>
            <div class="object col-xs-4"><center><img class="item"/></center></div>
			<div class="language col-xs-1" data-language="en-us"><button type="button" data-toggle="modal" data-target="#idiomModal">language</button></div>
			
		</div>

		<div id="all-letters" class="col-xs-6"></div>	


		<div id="guess" class="col-xs-12"></div>	

	</content>

<!-- <button id="win" type="button" data-toggle="modal" data-target="#winModal">win</button> -->
<!-- <button id="try" type="button" data-toggle="modal" data-target="#tryModal">try again</button> -->


	<footer id="footer" class="col-xs-12">
		<center>
			<button class="sound col-xs-1"><span>sound</span></button>
			<button class="music col-xs-1"><span>music</span></button>
			<button class="level col-xs-1"><span>level</span></button>
			<div class="col-xs-5"></div>
			<button class="repeat col-xs-1"><span>repeat</span></button>
			<button class="say col-xs-1"><span>say</span></button>
			<button class="hint col-xs-1"><span>hint</span></button>
			<button class="switch col-xs-1"><span>switch</span></button>
		</center>
	</footer>



<!-- User modal -->
<div class="modalbig">
    <div class="modal fade" id="userModal" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true"></span></button>
            <h4 class="modal-title">My user status</h4>
            <h4 class="modal-title change-avatar hide">Select your avatar</h4>
          </div>
          <div class="modal-body row">

            <!-- User Status container -->
            <div id="user-status" class="container-fluid bd-example-row modal-container">
                <div class="row line1">
                    <svg id="svg-dog-user" class="dog-user col-xs-offset-1 col-xs-6"></svg>
                    <div class="user-status col-xs-5">
                        <img src="images/avatar/01.svg" alt="spell"/>
                        <div id="usercoins"><span class="coins">1200</span></div>
                    </div> 
                </div>
                <div class="row line2">
                    <button type="button" class="btn-user change-avatar col-xs-4"><img src="images/change-avatar.svg" alt="Change Avatar"/></button>
                    <a href="select-user.html"><button type="button" class="btn-user change-user col-xs-4"><img src="images/change-user.svg" alt="Change User"/></button></a>
                    <button type="button" class="btn-user logout col-xs-4"><img class="pt" src="images/logout.svg" alt="logout"/></button>
                </div>
            </div><!-- end of user Status container -->
            <!-- change Avatar -->
            <div id="change-avatar" class="container-fluid bd-example-row modal-container hide">
                <div class="row line1">
                    <svg id="svg-dog-selecteavatar" class="dog-selecteavatar col-xs-offset-4 col-xs-5"></svg>
                </div>
                <div class="row line2">                       
                    <div class="select-avatar col-xs-12">
                        <span class="avatar one col-xs-2"><img src="images/avatar/01.svg"></span>
                        <span class="avatar two col-xs-2"><img src="images/avatar/02.svg"></span>
                        <span class="avatar three col-xs-2"><img src="images/avatar/03.svg"></span>
                        <span class="avatar four col-xs-2"><img src="images/avatar/04.svg"></span>
                        <span class="avatar five col-xs-2"><img src="images/avatar/05.svg"></span>
                        <span class="avatar six col-xs-2"><img src="images/avatar/06.svg"></span>
                        <span class="avatar seven col-xs-2"><img src="images/avatar/07.svg"></span>
                        <span class="avatar eight col-xs-2"><img src="images/avatar/08.svg"></span>
                        <span class="avatar nine col-xs-2"><img src="images/avatar/09.svg"></span>
                        <span class="avatar ten col-xs-2"><img src="images/avatar/10.svg"></span>
                        <span class="avatar eleven col-xs-2"><img src="images/avatar/11.svg"></span>
                        <span class="avatar twelve col-xs-2"><img src="images/avatar/12.svg"></span>
                    </div>
                </div>
                <div id="next" class="col-xs-offset-10 col-xs-2">
                    <button type="submit"><img src="images/next.svg" alt="next"/></button>
                </div>
            </div>
            <!-- end of create Avatar form container -->


          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
</div> 

<!-- Idiom modal -->
<div class="modalbig">
    <div class="modal fade" id="idiomModal" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true"></span></button>
            <h4 class="modal-title">Select a language</h4>
          </div>
          <div class="modal-body row">
            <div class="container-fluid bd-example-row">
                <div class="row line1">
                    <svg id="svg-dog-language" class="dog-language col-xs-offset-2 col-xs-8"></svg>
                </div>
                <div class="row">
                    <button type="button" class="btn-flag us col-xs-2 col-xs-offset-3"><img src="images/flagbig-us.svg" alt="flag us"/><h6>English</h6></button>
                    <button type="button" class="btn-flag es col-xs-2 col-xs-offset-2"><img src="images/flagbig-es.svg" alt="flag Espanish"/><h6>Spanish</h6></button>
                </div>
            </div>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
</div> 


<!-- win modal -->
<div class="modalwin">
	<div class="modal fade" id="winModal" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false">
	  <div class="modal-dialog" role="document">
	    <div class="modal-content winbg">
          <div class="modal-header row">
          	<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">X</span></button>
	        <h4 class="modal-title col-xs-3"><svg id="svg-dog-win" class="dog-win"></svg></h4>
            <h4 class="modal-title col-xs-9"><img src="images/welldone-text.svg" alt="spell"/></h4>
	      </div>
          <div class="modal-body row">
            <div class="container-fluid bd-example-row">
                <div class="row line1">
                    <div id="win-all-letters" class="col-xs-12">
<!--
                    	<span class="win-letter">t</span>
                    	<span class="win-letter">u</span>
                    	<span class="win-letter">r</span>
                    	<span class="win-letter">t</span>
                    	<span class="win-letter">l</span>
                    	<span class="win-letter">e</span>
-->
                    </div>    
                </div>
                <div class="row line2">
                    <div id="win-result" class="col-xs-6 col-xs-offset-3">
                        <span class="win-number col-xs-offset-1 col-xs-2">5</span>
                        <span class="win-star col-xs-2"><img src="images/win-star.svg" alt="star"/></span>
                        <span class="win-equal col-xs-2">=</span>
                        <span class="win-total col-xs-2">75</span>
                        <span class="win-coins col-xs-2"><img src="images/win-coins.svg" alt="coins"/></span>
                    </div>    
                </div>
                <div class="row modal-btn line3">
                    <center class="col-xs-12">
                        <button class="level col-xs-2 col-xs-offset-2"><span>level</span></button>
                        <button class="repeat col-xs-2 col-xs-offset-1"><span>repeat</span></button>
                        <button class="next col-xs-3"><span>next</span></button>
                    </center> 
                </div>
            </div>
          </div>
	    </div><!-- /.modal-content -->
	  </div><!-- /.modal-dialog -->
	</div><!-- /.modal -->
</div> 


<!-- Try again modal -->
<div class="modaltry">
	<div class="modal fade" id="tryModal" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false">
	  <div class="modal-dialog" role="document">
	    <div class="modal-content trybg">
          <div class="modal-header row" >
          	<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">X</span></button>
	        <h4 class="modal-title col-xs-4"><svg id="svg-dog-tryagain" class="dog-tryagain"></svg></h4>
            <h4 class="modal-title col-xs-8"><img src="images/tryagain-text.svg" alt="spell"/></h4>
	      </div>

          <div class="modal-body row">
            <div class="container-fluid bd-example-row">
                <div class="row line1">
                	<span class="takehint col-xs-12">Take this hint and play again!</span>
                    <div id="try-all-letters" class="col-xs-12">
<!--
                    	<span class="try-letter">*</span>
                    	<span class="try-letter">u</span>
                    	<span class="try-letter">*</span>
                    	<span class="try-letter">t</span>
                    	<span class="try-letter">*</span>
                    	<span class="try-letter">e</span>
-->
                    </div>    
                </div>
                <div class="row modal-btn line2">
                    <center class="col-xs-12">
                        <button class="level col-xs-2 col-xs-offset-2"><span>level</span></button>
                        <button class="repeat col-xs-2 col-xs-offset-1"><span>repeat</span></button>
                        <button class="next col-xs-3"><span>next</span></button>
                    </center> 
                </div>
            </div>
          </div>
	    </div><!-- /.modal-content -->
	  </div><!-- /.modal-dialog -->
	</div><!-- /.modal -->
</div> 

<audio id="background-music" loop autobuffer>
  <source src="sound/rainbows.mp3" />
</audio>


<script src="https://www.gstatic.com/firebasejs/3.6.3/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyBGLxtDt3wGB-QbRxLN7nlUydZCDzMk7vs",
    authDomain: "spell-thedog.firebaseapp.com",
    databaseURL: "https://spell-thedog.firebaseio.com",
    storageBucket: "spell-thedog.appspot.com",
    messagingSenderId: "708879136829"
  };
  firebase.initializeApp(config);
    var database = firebase.database();
</script>
<script src="js/all.js"></script>
<script type="text/javascript" src="js/dictionary.js"></script>
<script type="text/javascript" src="js/game.js"></script>

<script type="text/javascript">
    
/*** Load svg ***/

    var svglanguage = Snap("#svg-dog-language");
        Snap.load("images/dog-language.svg", function (f) {
        g = f.select("svg");
        svglanguage.append(g);   
    });

    var svgseated = Snap("#svg-dog-seated");
        Snap.load("images/dog-seated.svg", function (f) {
        g = f.select("svg");
        svgseated.append(g);   
    });

    var svgselecteavatar = Snap("#svg-dog-selecteavatar");
        Snap.load("images/dog-selecteavatar.svg", function (f) {
        g = f.select("svg");
        svgselecteavatar.append(g);   
    });

    var svguser = Snap("#svg-dog-user");
        Snap.load("images/dog-userstatus.svg", function (f) {
        g = f.select("svg");
        svguser.append(g);   
    });


    var svgwin = Snap("#svg-dog-win");
        Snap.load("images/dog-win.svg", function (f) {
        g = f.select("svg");
        svgwin.append(g);   
    });

    var svgtryagain = Snap("#svg-dog-tryagain");
        Snap.load("images/dog-tryagain.svg", function (f) {
        g = f.select("svg");
        svgtryagain.append(g);   
    });

//show change avatar
$(".btn-user.change-avatar, .user-status img").on('click', function(){
    $(".modal-title, .modal-container").addClass("hide");
    $("h4.change-avatar, #change-avatar").removeClass("hide");
});

//reset modal
$(".close").on('click', function(){
    $(".modal-title, .modal-container").removeClass("hide");
    $("h4.change-avatar, #change-avatar").addClass("hide");
});



// $(document).ready(function(){
//         var audio = new Audio('sound/letsplay.mp3');
//         setTimeout(function() {
//             audio.play();
//         }, 1000);
//     });
firebase.auth().onAuthStateChanged(function(user) {
    // not logged in
    if (!user) {
        return;
    }
    setup_coins($("#usercoins .coins"));
    setup_avatar($("#useravatar img, .user-status img"), "images/avatar");
});

setup_change_avatar(
    $("#change-avatar .select-avatar .avatar"),
    $("#change-avatar #next"),
    function() {
        $("#userModal").modal("hide");
    }
);
$("#user-status .logout").on('click', function() {
    logout();
});



    /*** sound effects ***/
    // play sound on click
    $(".close").on('click', play_click);
    $("#footer .sound, #footer .home, #footer .music, #footer .hint, #footer .switch").on('click', play_pop);
    $("#footer .repeat, .modal-btn .repeat").on('click', play_reload);
    $("#useravatar img, .user-status img, .btn-user, .avatar, .btn-flag, .language, .modal-btn .level, .modal-btn .next, button.level ").on('click', play_bubble);

setup_sound($("footer .sound"));
setup_music($("footer .music"), $("#background-music"));






// `location.hash` should be like "#animals,easy"
var theme = location.hash.slice(1).split(",")[0] || "animals";
var level = location.hash.slice(1).split(",")[1] || "easy";
// english is the default language
var language = "en-us";

var game = new Game({
    theme: theme,
    language: language,
    level: level,
    all_letters: $("#all-letters"),
    guess: $("#guess"),
    object: $(".object .item"),
    stars: $("#stars"),

    repeat_button: $("#footer .repeat"),
    say_button: $("#footer .say"),
    switch_button: $("#footer .switch"),
    hint_button: $("#footer .hint"),

    win_box: $("#win-all-letters"),
    try_again_box: $("#try-all-letters"),

    on_win: function (coins, points) {
        console.log("win");
        var audio = new Audio("sound/effects/win.mp3");
        audio.play();
        save_user_points(points);
        $("#win-result .win-number").html(coins);
        $("#win-result .win-total").html(points);
        $("#winModal").modal('show');
    },
    on_try_again: function() {
        console.log("try again");
        var audio = new Audio("sound/effects/tryagain.mp3");
        audio.play();
        $("#tryModal").modal('show');
    }
});
game.start_guess();

$(".btn-flag.es").on('click', function () {
    var lang = "es-sp";
    game.change_language(lang);
    $("#idiomModal").modal("hide");
    $("#figure .language").attr("data-language", lang)
});
$(".btn-flag.us").on('click', function () {
    var lang = "en-us";
    game.change_language(lang);
    $("#idiomModal").modal("hide");
    $("#figure .language").attr("data-language", lang)
});


$("button.level, .modal-btn .level").on('click', function () {
    play_bubble();
    setTimeout(function() {
        goToLevel();
    }, 1000);
});


// set up repeat/next actions for modals
$("#winModal .repeat, #tryModal .repeat").on('click', function() {
    $("#winModal").modal('hide');
    $("#tryModal").modal('hide');
    game.repeat();
});
$("#winModal .next, #tryModal .next").on('click', function() {
    $("#winModal").modal('hide');
    $("#tryModal").modal('hide');
    game.reset();
});
</script>


	</body>
</html>
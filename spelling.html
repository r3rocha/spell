<!DOCTYPE html>
<html>
	<head>
		<title>Spell, the dog | Kids spelling game</title>
		
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    	<link rel="shortcut icon" type="image/x-icon" href="images/favicon.png" />
		<link rel="stylesheet" type="text/css" href="slick/slick.css"/>
		<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="slick/slick-theme.css"/>
		<link rel="stylesheet" type="text/css" href="css/style.css">
		<script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
		<script src="js/bootstrap.min.js"></script>
	
	</head>
	<body id="game" class="grad">

		<header id="header" class="col-xs-12">

			<div id="user" class="col-xs-3 col-xs-offset-9">
				<div id="useravatar"><img src="images/avatar.svg"></div>
				<div id="usercoins"><span class="coins">1200</span></div>
			</div>

		</header>
	
		<content id="content" class="row">

			<div id="figure">
				<img class="dog-spelling col-xs-2" src="images/dog-spelling.svg" alt="spell "/>
                <div class="object col-xs-4"><center><img class="item" src="images/words/turtle.svg" alt="Turtle"/></center></div>
				<div class="language col-xs-1"><button type="button">language</button></div>
				
			</div>

			<div id="all-letters" class="col-xs-6"></div>	


			<div id="guess" class="col-xs-12"></div>	
	
		</content>



		<footer id="footer" class="col-xs-12">
			<center>
				<button class="sound col-xs-1"><span>sound</span></button>
				<button class="music col-xs-1"><span>music</span></button>
				<button class="home col-xs-1"><span>home</span></button>
				<div class="col-xs-5"></div>
				<button class="repeat col-xs-1"><span>repeat</span></button>
				<button class="say col-xs-1"><span>say</span></button>
				<button class="hint col-xs-1"><span>hint</span></button>
				<button class="switch col-xs-1"><a href="javascript:history.go(0)"><span>switch</span></a></button>
			</center>
		</footer>


<!-- 
	<button class="theme-more" type="button" data-toggle="modal" data-target="#myModal"><img src="images/more.svg" alt="More"></button>-->
	
		<!--<div>
			 modal
			<div class="modal fade" id="myModal" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false">
			  <div class="modal-dialog" role="document">
			    <div class="modal-content">
			      
			      <div class="modal-header">
			        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
			        <h4 class="modal-title">Forgot Password</h4>
			      </div>
			      
			      <div class="modal-body">
			        <form>
			          <input type="text" name="username">
			        </form>

			      </div>
			      
			      <div class="modal-footer">
			        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			        <button type="button" class="btn btn-primary">Save changes</button>
			      </div>
			    
			    </div>/.modal-content
			  </div>/.modal-dialog
			</div>/.modal
		</div> -->

<script type="text/javascript">

            // taken from http://stackoverflow.com/a/2450976/565999
            function shuffle(array) {
              var currentIndex = array.length, temporaryValue, randomIndex;

              // While there remain elements to shuffle...
              while (0 !== currentIndex) {

                // Pick a remaining element...
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex -= 1;

                // And swap it with the current element.
                temporaryValue = array[currentIndex];
                array[currentIndex] = array[randomIndex];
                array[randomIndex] = temporaryValue;
              }

              return array;
            }

            function Game(words, $all_letters, $guess) {
                this.words = words;
                this.$all_letters = $all_letters;
                this.$guess = $guess;
            }

            Game.prototype.start_guess = function() {
                var word = this.pick_word();
                this.setup_word_letters(word);
                this.setup_guess_box(word);
            };

            Game.prototype.pick_word = function() {
                return shuffle(this.words)[0];
            };

            Game.prototype.setup_word_letters = function(word) {
                var self = this;
                var letters_shuffled = shuffle(word.split(''));
                letters_shuffled.forEach(function(letter, index) {
                    var $letter = $('<span draggable="true"  class="letter">' + letter + "</span>");
                    self.$all_letters.append($letter);
                    $letter.on("dragstart", function(event) {
                        event.originalEvent.dataTransfer.setData("text", letter + index);
                        event.originalEvent.dataTransfer.effectAllowed = "move";

                    });
                });
            };

            Game.prototype.setup_guess_box = function(word) {
                var self = this;
                word.split('').forEach(function(letter, index) {
                    var $letter = $('<span class="letter" data-expected="' + letter + '">&nbsp;</span>');
                    self.$guess.append($letter);
                    $letter.on("dragover", function(event) {
                        event.preventDefault();
                    });
                    $letter.on("dragenter", function(event) {
                        $(this).addClass("over");
                    });
                    $letter.on("dragleave", function(event) {
                        $(this).removeClass("over");
                    });
                    $letter.on("drop", function(event) {
                        event.preventDefault();
                        var letter_and_index = event.originalEvent.dataTransfer.getData("text");
                        var letter_dropped = letter_and_index[0];
                        var index = parseInt(letter_and_index.slice(1), 10);
                        self.$all_letters.find(":nth(" + index + ")").hide();
                        $(this).html(letter_dropped);
                        $(this).removeClass("over");
                        if (letter_dropped === letter) {
                            $(this).addClass("over-right");
                        } else {
                            $(this).addClass("over-wrong");
                        }


                    });
                });
            };

            var game = new Game(["turtle", "hello"], $("#all-letters"), $("#guess"));
            game.start_guess();

        </script>


	</body>
</html>